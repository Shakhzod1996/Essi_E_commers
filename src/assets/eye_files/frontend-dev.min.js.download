"use strict";var ajax_url=cwginstock.ajax_url;var security_error=cwginstock.security_error;var userid=cwginstock.user_id;var emptyname=cwginstock.empty_name;var emptyemail=cwginstock.empty_email;var invalidemail=cwginstock.invalid_email;var recaptcha_enabled=cwginstock.enable_recaptcha;var recaptcha_site_key=cwginstock.recaptcha_site_key;var recaptcha_verify_enabled=cwginstock.enable_recaptcha_verify;var recaptcha_secret_present=cwginstock.recaptcha_secret_present;var is_iagree=cwginstock.is_iagree_enable;var iagree_error=cwginstock.iagree_error;var is_v3_recaptcha=cwginstock.is_v3_recaptcha;var is_popup=cwginstock.is_popup;var googlerecaptcha_widget_id=null;var gtoken="";var iti;var phone_field=cwginstock.phone_field;var subscriber_phone="";var phone_meta_data="";var phone_error=cwginstock.phone_field_error;var is_phone_field_optional=cwginstock.is_phone_field_optional;var default_country_code=cwginstock.default_country_code;function cwginstock_recaptcha_callback(a){document.getElementsByClassName("cwgstock_button")[0].disabled=false;if(recaptcha_verify_enabled=="1"&&recaptcha_secret_present=="yes"){document.getElementsByClassName("cwg-security")[0].value=a}}var instock_notifier={init:function(){if(is_popup=="no"){instock_notifier.generate_v3_response()}jQuery(document).on("click",".cwgstock_button",this.submit_form);jQuery(".single_variation_wrap").on("show_variation",this.perform_upon_show_variation);if(phone_field=="1"){instock_notifier.initialize_phone()}},initialize_phone:function(){var a=document.querySelector(".cwgstock_phone");if(a){iti=window.intlTelInput(a,{allowDropdown:true,formatOnDisplay:true,autoHideDialCode:false,separateDialCode:true,utilsScript:cwginstock.phone_utils_js,initialCountry:default_country_code,customPlaceholder:function(b,c){default_country_code=default_country_code.toLowerCase();if(default_country_code==c.iso2){if(cwginstock.custom_country_placeholder!=""){return cwginstock.custom_country_placeholder}}return b}})}},perform_upon_show_variation:function(c,b){var a=b.variation_id;jQuery(".cwginstock-subscribe-form").hide();jQuery(".cwginstock-subscribe-form-"+a).show();if(recaptcha_enabled=="1"){instock_notifier.onloadcallback()}if(phone_field=="1"){instock_notifier.initialize_phone()}},generate_v3_response:function(){if(recaptcha_enabled=="1"&&is_v3_recaptcha=="yes"){grecaptcha.ready(function(){grecaptcha.execute(recaptcha_site_key,{action:"subscribe_form"}).then(function(b){var a=document.getElementsByClassName("cwg-security");if(a.length>0){document.getElementsByClassName("cwg-security")[0].value=b;document.getElementsByClassName("cwgstock_button")[0].disabled=false;gtoken=b}})})}},is_email:function(a){var b=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;return b.test(a)},submit_form:function(h){h.preventDefault();var a=jQuery(this);var l=jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_name").val();var b=jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_email").val();if(phone_field=="1"){var m=iti.getNumber();phone_meta_data=iti.getSelectedCountryData();if(!iti.isValidNumber()){var j=iti.getValidationError();console.log(j);var g=phone_error[j];if(j==-99){g=phone_error[0]}if((j!=-99&&is_phone_field_optional=="1")||is_phone_field_optional=="2"){jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").fadeIn();jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").html("<div class='cwginstockerror' style='color:red;'>"+g+"</div>");return false}}}var d=jQuery(this).closest(".cwginstock-subscribe-form").find(".cwg-product-id").val();var i=jQuery(this).closest(".cwginstock-subscribe-form").find(".cwg-variation-id").val();if(l==""){jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").fadeIn();jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").html("<div class='cwginstockerror' style='color:red;'>"+emptyname+"</div>");return false}else{if(b==""){jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").fadeIn();jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").html("<div class='cwginstockerror' style='color:red;'>"+emptyemail+"</div>");return false}else{if(!instock_notifier.is_email(b)){jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").fadeIn();jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").html("<div class='cwginstockerror' style='color:red;'>"+invalidemail+"</div>");return false}if(is_iagree=="1"){if(!jQuery(this).closest(".cwginstock-subscribe-form").find(".cwg_iagree_checkbox_input").is(":checked")){jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").fadeIn();jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").html("<div class='cwginstockerror' style='color:red;'>"+iagree_error+"</div>");return false}}var k=jQuery(this).closest(".cwginstock-subscribe-form").find(".cwg-security").val();var f={action:"cwginstock_product_subscribe",product_id:d,variation_id:i,subscriber_name:l,subscriber_phone:m,subscriber_phone_meta:phone_meta_data,user_email:b,user_id:userid,security:k,dataobj:cwginstock};if(jQuery.fn.block){a.closest(".cwginstock-subscribe-form").block({message:null})}else{var c=jQuery('<div id="cwg-bis-overlay"> </div>');c.appendTo(a.closest(".cwginstock-subscribe-form"))}instock_notifier.perform_ajax(f,a)}}},recaptcha_callback:function(a){var b=document.getElementsByClassName("cwg-security");if(b.length>0){document.getElementsByClassName("cwgstock_button")[0].disabled=false;if(recaptcha_verify_enabled=="1"&&recaptcha_secret_present=="yes"){document.getElementsByClassName("cwg-security")[0].value=a}}},onloadcallback:function(){if(recaptcha_enabled=="1"){if(is_v3_recaptcha=="no"){if(jQuery("#cwg-google-recaptcha").length){if(googlerecaptcha_widget_id===null){googlerecaptcha_widget_id=grecaptcha.render("cwg-google-recaptcha",{sitekey:recaptcha_site_key,callback:this.recaptcha_callback})}else{grecaptcha.reset(googlerecaptcha_widget_id);this.recaptcha_callback();googlerecaptcha_widget_id=null;instock_notifier.onloadcallback()}}}else{instock_notifier.generate_v3_response()}}},resetcallback:function(){if(recaptcha_enabled=="1"){if(is_v3_recaptcha=="no"){grecaptcha.reset();document.getElementsByClassName("cwgstock_button")[0].disabled=true}else{instock_notifier.generate_v3_response()}}},perform_ajax:function(b,a){jQuery.ajax({type:"post",url:ajax_url,data:b,beforeSend:function(c){c.setRequestHeader("X-WP-Nonce",cwginstock.security)},success:function(c){c=c.msg;a.closest(".cwginstock-subscribe-form").find(".cwgstock_output").fadeIn(2000);a.closest(".cwginstock-subscribe-form").find(".cwgstock_output").html(c);if(jQuery.fn.block){a.closest(".cwginstock-subscribe-form").unblock()}else{a.closest(".cwginstock-subscribe-form").find("#cwg-bis-overlay").fadeOut(400,function(){a.closest(".cwginstock-subscribe-form").find("#cwg-bis-overlay").remove()})}instock_notifier.resetcallback();jQuery(document).trigger("cwginstock_success_ajax",b)},error:function(e,c,d){if(typeof e.responseJSON!=="undefined"){if(e.responseJSON.hasOwnProperty("code")){if(typeof e.responseJSON.code!=="undefined"){if((e.responseJSON.code=="rest_cookie_invalid_nonce")||(e.responseJSON.code=="cwg_nonce_verify_failed")){e.responseText=-1}}}}if(e.responseText==="-1"||e.responseText===-1){a.closest(".cwginstock-subscribe-form").find(".cwgstock_output").fadeIn(2000);a.closest(".cwginstock-subscribe-form").find(".cwgstock_output").html("<div class='cwginstockerror' style='color:red;'>"+security_error+"</div>")}if(jQuery.fn.block){a.closest(".cwginstock-subscribe-form").unblock()}else{a.closest(".cwginstock-subscribe-form").find("#cwg-bis-overlay").fadeOut(400,function(){a.closest(".cwginstock-subscribe-form").find("#cwg-bis-overlay").remove()})}instock_notifier.resetcallback();jQuery(document).trigger("cwginstock_error_ajax",b)}})}};instock_notifier.init();